{"ast":null,"code":"var _jsxFileName = \"/Users/jennifervphan/Desktop/final project/grandmeet-client/src/components/commonRoom/Chat.jsx\";\nimport React from 'react';\nimport { Grid, List, Comment, Form, Input } from 'semantic-ui-react';\nimport GameBoard from './GameBoard';\nexport default class Chat extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      users: this.props.room.userIds,\n      messages: [],\n      newMessage: ''\n    };\n    props.user.subscribeToRoom({\n      roomId: props.room.id,\n      messageLimit: 50,\n      onUserJoined: user => {\n        debugger;\n        let filtered = props.room.users.filter(user => {\n          return user.presence.state === 'online';\n        });\n        console.log(\"hereis filter\" + filtered);\n        this.setState({\n          users: filtered\n        });\n      },\n      onUserLeft: user => {\n        this.setState({\n          users: props.room.users\n        });\n      },\n      onMessage: message => {\n        const messages = this.state.messages;\n        let opponent;\n\n        if (message.attachment && message.attachment.link && message.attachment.link.startsWith('urn:player:')) {\n          opponent = message.attachment.link.substring(11);\n\n          if (opponent !== props.user.id) {\n            opponent = undefined;\n          }\n        }\n\n        messages.push({\n          id: message.id,\n          user: message.senderId,\n          message: this.state.newMessage,\n          opponent: opponent\n        });\n        this.setState({\n          messages: [...messages, message]\n        });\n      }\n    }).then(currentRoom => {\n      this.setState({\n        users: currentRoom.userIds\n      });\n    });\n  }\n\n  render() {\n    const users = this.state.users.filter(user => user.id !== this.props.user.id).map(user => React.createElement(\"li\", {\n      style: {\n        listStyle: \"none\"\n      },\n      key: user.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      style: {\n        margin: \"0\",\n        padding: \"0\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, user.name), React.createElement(\"p\", {\n      style: {\n        floated: 'right'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      onClick: () => this._challengePlayer(user),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, \"Challenge\"))));\n    const messages = this.state.messages.map(message => {\n      let acceptGame;\n\n      if (message.opponent) {\n        acceptGame = React.createElement(\"a\", {\n          onClick: () => this._acceptChallenge(message.user),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78\n          },\n          __self: this\n        }, \"Accept Challenge\");\n      }\n\n      return (// <div key={message.id}>\n        React.createElement(\"div\", {\n          className: \"columnFlex\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83\n          },\n          __self: this\n        }, React.createElement(\"h4\", {\n          className: \"flexpart\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, message.user), React.createElement(\"p\", {\n          className: \"flexpart\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, message.text), acceptGame) // </div>\n\n      );\n    });\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      className: \"rowFlex\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"allMessages\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, this.props.game && React.createElement(GameBoard, {\n      room: this.props.game,\n      user: this.props.user,\n      ref: child => {\n        this._gameBoard = child;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ColumnFlex\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, messages), React.createElement(\"div\", {\n      style: {\n        float: \"left\",\n        clear: \"both\"\n      },\n      ref: el => {\n        this.messagesEnd = el;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"availableUsers\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      style: {\n        listStyle: \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, \"You: \", this.props.user.name)), users))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Form, {\n      onSubmit: this._handleSubmit.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"typeText\",\n      type: \"text\",\n      placeholder: \"New Message...\",\n      value: this.state.newMessage,\n      onChange: this._handleNewMessageChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }))));\n  }\n\n  componentDidMount() {\n    this._scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this._scrollToBottom();\n  }\n\n  _scrollToBottom() {\n    this.messagesEnd.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }\n\n  _handleNewMessageChange(e) {\n    this.setState({\n      newMessage: e.target.value\n    });\n  }\n\n  _handleSubmit() {\n    const newMessage = this.state.newMessage;\n    const _this$props = this.props,\n          user = _this$props.user,\n          room = _this$props.room;\n    user.sendMessage({\n      text: newMessage,\n      roomId: room.id\n    });\n    this.setState({\n      newMessage: ''\n    });\n  }\n\n  _challengePlayer(player) {\n    const _this$props2 = this.props,\n          user = _this$props2.user,\n          room = _this$props2.room;\n    user.sendMessage({\n      text: \"I challenge \".concat(player.name, \" to a game\"),\n      roomId: room.id,\n      attachment: {\n        link: \"urn:player:\".concat(player.id),\n        type: 'file',\n        fetchRequired: false\n      }\n    });\n  }\n\n  _acceptChallenge(player) {\n    const user = this.props.user;\n    user.createRoom({\n      name: \"\".concat(user.id, \" vs \").concat(player),\n      addUserIds: [player]\n    }).then(room => {\n      this.props.startedGame(room.id, user.id, player);\n    });\n  }\n\n  getPlayersInRoom() {\n    const players = this._gameBoard ? this._gameBoard.getPlayers() : [];\n    const playersInRoom = this.state.users.filter(user => players.includes(user.id));\n    return playersInRoom;\n  }\n\n}","map":{"version":3,"sources":["/Users/jennifervphan/Desktop/final project/grandmeet-client/src/components/commonRoom/Chat.jsx"],"names":["React","Grid","List","Comment","Form","Input","GameBoard","Chat","Component","constructor","props","state","users","room","userIds","messages","newMessage","user","subscribeToRoom","roomId","id","messageLimit","onUserJoined","filtered","filter","presence","console","log","setState","onUserLeft","onMessage","message","opponent","attachment","link","startsWith","substring","undefined","push","senderId","then","currentRoom","render","map","listStyle","margin","padding","name","floated","_challengePlayer","acceptGame","_acceptChallenge","text","game","child","_gameBoard","float","clear","el","messagesEnd","_handleSubmit","bind","_handleNewMessageChange","componentDidMount","_scrollToBottom","componentDidUpdate","scrollIntoView","behavior","e","target","value","sendMessage","player","type","fetchRequired","createRoom","addUserIds","startedGame","getPlayersInRoom","players","getPlayers","playersInRoom","includes"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Grid, List, Comment, Form, Input } from 'semantic-ui-react';\nimport GameBoard from './GameBoard';\n\nexport default class Chat extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            users: this.props.room.userIds,\n            messages: [],\n            newMessage: ''\n        };\n\n        props.user.subscribeToRoom({\n            roomId: props.room.id,\n            messageLimit: 50,\n                onUserJoined: (user) => {\n                    debugger\n                    let filtered= props.room.users.filter(user=>{\n                        return user.presence.state === 'online'\n                    })\n                    console.log(\"hereis filter\"+filtered)\n                    this.setState({\n                        users: filtered\n                    });\n                },\n                onUserLeft: (user) => {\n                    this.setState({\n                        users: props.room.users\n                    });\n                },\n                onMessage: (message) => {\n                    const messages = this.state.messages;\n                    let opponent;\n                    if (message.attachment && message.attachment.link && message.attachment.link.startsWith('urn:player:')) {\n                        opponent = message.attachment.link.substring(11);\n                        if (opponent !== props.user.id) {\n                            opponent = undefined;\n                        }\n                    }\n                    messages.push({\n                        id: message.id,\n                        user: message.senderId,\n                        message: this.state.newMessage,\n                        opponent: opponent\n                    });\n                    this.setState({\n                        messages: [...messages, message]\n                    });\n                }\n            })\n        \n        .then(currentRoom=>{\n            this.setState({users: currentRoom.userIds})\n        })\n    }\n\n    render() {\n        const users = this.state.users\n            .filter((user) => user.id !== this.props.user.id)\n            .map((user) => (\n                <li style={{listStyle:\"none\"}} key={user.id}>\n                    <b style={{margin: \"0\", padding:\"0\"}}>\n                        { user.name }\n                    </b>\n                    <p style={{floated:'right'}}>\n                        <a onClick={() => this._challengePlayer(user)}>Challenge</a>\n                    </p>\n                </li>\n            ));\n\n        const messages = this.state.messages\n            .map((message) => {\n                let acceptGame;\n                if (message.opponent) {\n                    acceptGame = (\n                            <a onClick={() => this._acceptChallenge(message.user)}>Accept Challenge</a>\n                    );\n                }\n                return (\n                    // <div key={message.id}>\n                        <div className=\"columnFlex\">\n                            <h4 className=\"flexpart\">{ message.user}</h4>\n                            <p className=\"flexpart\">{ message.text }</p>\n                            { acceptGame }\n                        </div>\n                    // </div>\n                );\n            });\n\n        return (\n            <>\n                <div className=\"rowFlex\">\n                    <div className=\"allMessages\">\n                        { this.props.game && <GameBoard room={this.props.game} user={this.props.user} ref={(child) => { this._gameBoard = child; }}/> }\n                        <div className=\"ColumnFlex\" >\n                            { messages }\n                        </div>\n                        <div style={{ float:\"left\", clear: \"both\" }} ref={(el) => { this.messagesEnd = el; }} />\n                    </div>\n                    <div className=\"availableUsers\">\n                        <ul>\n                            <li style={{listStyle:\"none\"}}>\n                                <b>\n                                   You: { this.props.user.name }\n                                </b>\n                            </li>\n                            { users }\n                        </ul>\n                    </div>\n                </div>\n                <div>\n                    <Form onSubmit={this._handleSubmit.bind(this)}>\n                        <input className=\"typeText\" type=\"text\" placeholder='New Message...' value={this.state.newMessage} onChange={this._handleNewMessageChange.bind(this)} />\n                    </Form>\n                </div>\n            </>\n        );\n    }\n\n    componentDidMount() {\n        this._scrollToBottom();\n    }\n\n    componentDidUpdate() {\n        this._scrollToBottom();\n    }\n\n    _scrollToBottom() {\n        this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\n    }\n\n    _handleNewMessageChange(e) {\n        this.setState({\n            newMessage: e.target.value\n        });\n    }\n\n    _handleSubmit() {\n        const { newMessage } = this.state;\n        const { user, room } = this.props;\n        user.sendMessage({\n            text: newMessage,\n            roomId: room.id\n        });\n        this.setState({\n            newMessage: ''\n        });\n    }\n\n    _challengePlayer(player) {\n        const { user, room } = this.props;\n        user.sendMessage({\n            text: `I challenge ${player.name} to a game`,\n            roomId: room.id,\n            attachment: {\n                link: `urn:player:${player.id}`,\n                type: 'file',\n                fetchRequired: false\n            }\n        });\n    }\n\n    _acceptChallenge(player) {\n        const { user } = this.props;\n        user.createRoom({\n            name: `${user.id} vs ${player}`,\n            addUserIds: [player]\n        }).then((room) => {\n            this.props.startedGame(room.id, user.id, player);\n        });\n    }\n\n    getPlayersInRoom() {\n        const players = this._gameBoard ? this._gameBoard.getPlayers() : [];\n        const playersInRoom = this.state.users\n            .filter((user) => players.includes(user.id));\n        return playersInRoom;\n    }\n}"]},"metadata":{},"sourceType":"module"}